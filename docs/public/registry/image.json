{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "image",
  "type": "registry:ui",
  "title": "Image",
  "description": "Optimized image component with custom utilities. Note: Requires Next.js for next/image optimization.",
  "files": [
    {
      "path": "components/image.tsx",
      "type": "registry:ui",
      "content": "\"use client\";\n\nimport React, { useState, useEffect } from \"react\";\nimport NextImage, { ImageProps as NextImageProps } from \"next/image\";\nimport { twMerge } from \"tailwind-merge\";\nimport { Expand, X } from \"lucide-react\";\nimport FocusLock from \"react-focus-lock\";\nimport { useOverlay } from \"../contexts/overlay-context\";\nimport { useEscapeKey } from \"../hooks/use-escape-key\";\n\n// Support both Next.js Image and regular img elements\nexport type MacOSImageProps = (\n\t| (Omit<NextImageProps, \"className\" | \"onClick\"> & { useNext?: true })\n\t| (Omit<React.ImgHTMLAttributes<HTMLImageElement>, \"className\"> & {\n\t\t\tuseNext: false;\n\t  })\n) & {\n\tclassName?: string;\n\trounded?: \"none\" | \"sm\" | \"md\" | \"lg\" | \"xl\" | \"full\";\n\tclickToEnlarge?: boolean;\n};\n\nexport function Image({\n\tclassName,\n\trounded = \"md\",\n\tclickToEnlarge = false,\n\t...props\n}: MacOSImageProps) {\n\tconst [isEnlarged, setIsEnlarged] = useState(false);\n\tconst [isClosing, setIsClosing] = useState(false);\n\tconst [overlayId, setOverlayId] = useState<string | null>(null);\n\tconst { registerOverlay, unregisterOverlay } = useOverlay();\n\n\tconst roundedClass = {\n\t\tnone: \"\",\n\t\tsm: \"rounded-sm\",\n\t\tmd: \"rounded-md\",\n\t\tlg: \"rounded-lg\",\n\t\txl: \"rounded-xl\",\n\t\tfull: \"rounded-full\",\n\t}[rounded];\n\n\tconst baseClass = twMerge(roundedClass, className);\n\n\t// Register/unregister overlay when image viewer opens/closes\n\tuseEffect(() => {\n\t\tif (isEnlarged && !isClosing && !overlayId) {\n\t\t\tconst id = registerOverlay(\"image-viewer\", {\n\t\t\t\tblocksScroll: true,\n\t\t\t\tisFullscreen: true,\n\t\t\t});\n\t\t\tsetOverlayId(id);\n\t\t} else if (!isEnlarged && overlayId) {\n\t\t\tunregisterOverlay(overlayId);\n\t\t\tsetOverlayId(null);\n\t\t}\n\t}, [isEnlarged, isClosing, overlayId, registerOverlay, unregisterOverlay]);\n\n\t// Get the image source for the enlarged view\n\tconst getImageSrc = (): string => {\n\t\tif (\"src\" in props && typeof props.src === \"string\") {\n\t\t\treturn props.src;\n\t\t}\n\t\treturn \"\";\n\t};\n\n\tconst getImageAlt = (): string => {\n\t\tif (\"alt\" in props && typeof props.alt === \"string\") {\n\t\t\treturn props.alt;\n\t\t}\n\t\treturn \"Image\";\n\t};\n\n\tconst handleClose = () => {\n\t\tsetIsClosing(true);\n\t\tsetTimeout(() => {\n\t\t\tsetIsEnlarged(false);\n\t\t\tsetIsClosing(false);\n\t\t}, 200);\n\t};\n\n\t// ESC key to close\n\tuseEscapeKey(handleClose, isEnlarged);\n\n\t// Render the enlarged overlay\n\tconst renderEnlargedOverlay = () => {\n\t\tif (!isEnlarged || !clickToEnlarge) return null;\n\n\t\treturn (\n\t\t\t<FocusLock returnFocus>\n\t\t\t\t<div\n\t\t\t\t\tclassName={`fixed inset-0 bg-black/90 backdrop-blur-sm flex items-center justify-center p-4 ${\n\t\t\t\t\t\tisClosing\n\t\t\t\t\t\t\t? \"animate-out fade-out duration-200\"\n\t\t\t\t\t\t\t: \"animate-in fade-in duration-200\"\n\t\t\t\t\t}`}\n\t\t\t\t\tstyle={{ zIndex: \"var(--z-fullscreen)\" }}\n\t\t\t\t\tonClick={handleClose}\n\t\t\t\t\trole=\"dialog\"\n\t\t\t\t\taria-modal=\"true\"\n\t\t\t\t\taria-label={`Enlarged view of ${getImageAlt()}`}\n\t\t\t\t>\n\t\t\t\t\t<button\n\t\t\t\t\t\tclassName=\"absolute top-4 right-4 text-white/70 hover:text-white transition-colors cursor-pointer z-10\"\n\t\t\t\t\t\tonClick={(e) => {\n\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\thandleClose();\n\t\t\t\t\t\t}}\n\t\t\t\t\t\taria-label=\"Close image viewer\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<X className=\"w-8 h-8\" />\n\t\t\t\t\t</button>\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName={`relative max-w-7xl max-h-[90vh] ${\n\t\t\t\t\t\t\tisClosing\n\t\t\t\t\t\t\t\t? \"animate-out zoom-out-95 duration-200\"\n\t\t\t\t\t\t\t\t: \"animate-in zoom-in-95 duration-200\"\n\t\t\t\t\t\t}`}\n\t\t\t\t\t\tonClick={(e) => e.stopPropagation()}\n\t\t\t\t\t>\n\t\t\t\t\t\t<NextImage\n\t\t\t\t\t\t\tsrc={getImageSrc()}\n\t\t\t\t\t\t\talt={getImageAlt()}\n\t\t\t\t\t\t\twidth={1920}\n\t\t\t\t\t\t\theight={1080}\n\t\t\t\t\t\t\tclassName=\"object-contain rounded-lg max-w-full max-h-[90vh] w-auto h-auto\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</FocusLock>\n\t\t);\n\t};\n\n\t// Check if image has fill prop (for Next.js Image)\n\tconst hasFill = \"fill\" in props && props.fill === true;\n\n\t// Wrapper for click-to-enlarge functionality\n\tconst wrapWithClickToEnlarge = (element: React.ReactNode) => {\n\t\tif (!clickToEnlarge) return element;\n\n\t\t// For fill images, wrapper should be block and fill parent\n\t\t// For non-fill images, wrapper should be inline-block\n\t\tconst wrapperClass = hasFill\n\t\t\t? \"cursor-pointer group relative block w-full h-full\"\n\t\t\t: \"cursor-pointer group relative inline-block\";\n\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<div\n\t\t\t\t\tonClick={() => setIsEnlarged(true)}\n\t\t\t\t\tonKeyDown={(e) => {\n\t\t\t\t\t\tif (e.key === \"Enter\" || e.key === \" \") {\n\t\t\t\t\t\t\tsetIsEnlarged(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t}}\n\t\t\t\t\trole=\"button\"\n\t\t\t\t\ttabIndex={0}\n\t\t\t\t\tclassName={wrapperClass}\n\t\t\t\t>\n\t\t\t\t\t{element}\n\t\t\t\t\t<div className=\"absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-colors duration-300 flex items-center justify-center pointer-events-none rounded-lg\">\n\t\t\t\t\t\t<Expand className=\"text-white/0 group-hover:text-white/90 text-sm transition-all duration-300\" />\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t{renderEnlargedOverlay()}\n\t\t\t</>\n\t\t);\n\t};\n\n\t// Use Next.js Image by default, or regular img if useNext is false\n\tif (\"useNext\" in props && props.useNext === false) {\n\t\tconst { useNext: _useNext, ...imgProps } = props;\n\t\tconst imgElement = (\n\t\t\t<img\n\t\t\t\t{...(imgProps as React.ImgHTMLAttributes<HTMLImageElement>)}\n\t\t\t\tclassName={baseClass}\n\t\t\t/>\n\t\t);\n\t\treturn wrapWithClickToEnlarge(imgElement);\n\t}\n\n\t// Default to Next.js Image\n\tconst { useNext: _useNext, ...nextImageProps } = props as NextImageProps & {\n\t\tuseNext?: boolean;\n\t};\n\n\t// Add default sizes for fill images if not provided\n\tconst imagePropsWithSizes =\n\t\thasFill && !nextImageProps.sizes\n\t\t\t? { ...nextImageProps, sizes: \"100vw\" }\n\t\t\t: nextImageProps;\n\n\tconst imageElement = (\n\t\t<NextImage {...imagePropsWithSizes} className={baseClass} />\n\t);\n\treturn wrapWithClickToEnlarge(imageElement);\n}\n"
    }
  ]
}