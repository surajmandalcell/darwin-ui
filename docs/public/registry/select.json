{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "select",
  "type": "registry:ui",
  "title": "Select",
  "description": "Custom select/dropdown component with portal rendering and keyboard navigation.",
  "dependencies": [
    "@radix-ui/react-popover",
    "lucide-react"
  ],
  "registryDependencies": [
    "utils"
  ],
  "files": [
    {
      "path": "components/select.tsx",
      "type": "registry:ui",
      "content": "\"use client\";\n\nimport React from \"react\";\nimport { createPortal } from \"react-dom\";\nimport { cn } from \"../lib/utils\";\nimport { motion, AnimatePresence } from \"motion/react\";\n\ntype OptionLike = { value: string; label: React.ReactNode };\n\ninterface SelectProps\n\textends Omit<React.HTMLAttributes<HTMLDivElement>, \"onChange\" | \"children\"> {\n\tchildren: React.ReactNode;\n\tonChange?: (e: { target: { value: string } }) => void;\n\tvalue?: string;\n\tdefaultValue?: string;\n\tdisabled?: boolean;\n}\n\nexport function Select({\n\tchildren,\n\tclassName = \"\",\n\tvalue,\n\tdefaultValue,\n\tonChange,\n\tdisabled,\n\t...props\n}: SelectProps) {\n\tconst [open, setOpen] = React.useState(false);\n\tconst containerRef = React.useRef<HTMLDivElement | null>(null);\n\tconst buttonRef = React.useRef<HTMLButtonElement | null>(null);\n\tconst [dropdownPosition, setDropdownPosition] = React.useState({ top: 0, left: 0, width: 0 });\n\n\tconst options = React.useMemo<OptionLike[]>(() => {\n\t\treturn React.Children.toArray(children).flatMap((child) => {\n\t\t\tif (!React.isValidElement(child)) return [] as OptionLike[];\n\t\t\tconst props = child.props as {\n\t\t\t\tvalue?: string;\n\t\t\t\tchildren?: React.ReactNode;\n\t\t\t};\n\t\t\tconst val = props.value ?? String(props.children ?? \"\");\n\t\t\treturn [{ value: String(val), label: props.children }];\n\t\t});\n\t}, [children]);\n\n\tconst selected = React.useMemo(() => {\n\t\tconst v =\n\t\t\t(value as string) ?? (defaultValue as string) ?? options[0]?.value ?? \"\";\n\t\tconst match = options.find((o) => o.value === v);\n\t\treturn { value: v, label: match?.label ?? v };\n\t}, [value, defaultValue, options]);\n\n\tReact.useEffect(() => {\n\t\tif (open && buttonRef.current) {\n\t\t\tconst rect = buttonRef.current.getBoundingClientRect();\n\t\t\tsetDropdownPosition({\n\t\t\t\ttop: rect.bottom + window.scrollY + 4,\n\t\t\t\tleft: rect.left + window.scrollX,\n\t\t\t\twidth: rect.width,\n\t\t\t});\n\t\t}\n\t}, [open]);\n\n\tReact.useEffect(() => {\n\t\tfunction onDocClick(e: MouseEvent) {\n\t\t\tif (!containerRef.current) return;\n\t\t\tif (!containerRef.current.contains(e.target as Node)) setOpen(false);\n\t\t}\n\t\tif (open) document.addEventListener(\"mousedown\", onDocClick);\n\t\treturn () => document.removeEventListener(\"mousedown\", onDocClick);\n\t}, [open]);\n\n\tfunction handleSelect(val: string) {\n\t\tonChange?.({ target: { value: val } });\n\t\tsetOpen(false);\n\t}\n\n\tconst dropdown = typeof window !== \"undefined\" ? (\n\t\tcreatePortal(\n\t\t\t<AnimatePresence>\n\t\t\t\t{open && (\n\t\t\t\t\t<motion.div\n\t\t\t\t\t\tinitial={{ opacity: 0, scale: 0.95, y: -10 }}\n\t\t\t\t\t\tanimate={{ opacity: 1, scale: 1, y: 0 }}\n\t\t\t\t\t\texit={{ opacity: 0, scale: 0.95, y: -10 }}\n\t\t\t\t\t\ttransition={{ duration: 0.15, ease: \"easeOut\" }}\n\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\tposition: 'fixed',\n\t\t\t\t\t\t\ttop: `${dropdownPosition.top}px`,\n\t\t\t\t\t\t\tleft: `${dropdownPosition.left}px`,\n\t\t\t\t\t\t\tminWidth: `${dropdownPosition.width}px`,\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tclassName=\"z-50 min-w-[8rem] overflow-hidden rounded-md border border-white/10 bg-[#1a1a1a]/95 backdrop-blur-xl shadow-xl\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<ul role=\"listbox\" className=\"p-1\">\n\t\t\t\t\t\t\t{options.map((opt) => (\n\t\t\t\t\t\t\t\t<li\n\t\t\t\t\t\t\t\t\tkey={opt.value}\n\t\t\t\t\t\t\t\t\trole=\"option\"\n\t\t\t\t\t\t\t\t\taria-selected={opt.value === selected.value}\n\t\t\t\t\t\t\t\t\tonClick={() => handleSelect(opt.value)}\n\t\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\t\t\"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-2 text-sm outline-none transition-colors hover:bg-white/10 data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n\t\t\t\t\t\t\t\t\t\topt.value === selected.value ? \"bg-white/10 text-white\" : \"text-white/80\"\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{opt.label}\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t</motion.div>\n\t\t\t\t)}\n\t\t\t</AnimatePresence>,\n\t\t\tdocument.body\n\t\t)\n\t) : null;\n\n\treturn (\n\t\t<div\n\t\t\tref={containerRef}\n\t\t\tclassName={cn(\"relative inline-block w-full\", className)}\n\t\t\t{...props}\n\t\t>\n\t\t\t<button\n\t\t\t\tref={buttonRef}\n\t\t\t\ttype=\"button\"\n\t\t\t\tdisabled={disabled}\n\t\t\t\taria-haspopup=\"listbox\"\n\t\t\t\taria-expanded={open}\n\t\t\t\tonClick={() => setOpen((v) => !v)}\n\t\t\t\tclassName={cn(\n\t\t\t\t\t\"flex h-9 w-full items-center justify-between rounded-md border border-white/10 bg-white/5 px-3 py-2 text-sm text-white/90 shadow-sm ring-offset-background placeholder:text-white/50 focus:outline-none focus:ring-1 focus:ring-blue-500/50 disabled:cursor-not-allowed disabled:opacity-50 hover:bg-white/10 transition-colors backdrop-blur-sm\",\n\t\t\t\t)}\n\t\t\t>\n\t\t\t\t<span className=\"truncate\">{selected.label}</span>\n\t\t\t\t<span className=\"ml-2 h-4 w-4 opacity-50\">\n\t\t\t\t\t<motion.svg\n\t\t\t\t\t\tanimate={{ rotate: open ? 180 : 0 }}\n\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\twidth=\"24\"\n\t\t\t\t\t\theight=\"24\"\n\t\t\t\t\t\tviewBox=\"0 0 24 24\"\n\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\tstroke=\"currentColor\"\n\t\t\t\t\t\tstrokeWidth=\"2\"\n\t\t\t\t\t\tstrokeLinecap=\"round\"\n\t\t\t\t\t\tstrokeLinejoin=\"round\"\n\t\t\t\t\t\tclassName=\"h-4 w-4\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<path d=\"m6 9 6 6 6-6\" />\n\t\t\t\t\t</motion.svg>\n\t\t\t\t</span>\n\t\t\t</button>\n\t\t\t{dropdown}\n\t\t</div>\n\t);\n}"
    }
  ]
}